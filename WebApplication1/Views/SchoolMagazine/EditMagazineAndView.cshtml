@model WebApplication1.ViewModels.SchoolMagazineViewModel

<form asp-action="FilterBySubject" asp-controller="SchoolMagazine" asp-route-Class="@ViewBag.ClassNumber" asp-route-ClassLetter="@ViewBag.ClassLetter" method="post">
    <div class="form-group">
        <select class="form-control" name="Subject" id="Subject">
            @foreach (var cl in ViewBag.subjects)
            {
                <option>@cl</option>
            }
        </select>
        <select class="form-control" name="Quarters" id="Quarters">
            @foreach (var cl in ViewBag.Quarters)
            {
                <option>@cl</option>
            }
        </select>
    </div>
    <button type="submit" class="btn btn-danger btn-rounded" style="float: right; font-size: 12px;" name="button">
        Выбрать
    </button> <br />
</form>
<form method="post" asp-controller="SchoolMagazine" asp-action="SaveMagazine" asp-route-Class="@ViewBag.ClassNumber" asp-route-ClassLetter="@ViewBag.ClassLetter">
    <input type="text" asp-for="Subject" hidden id="sub" />
    <table class="table table-bordered table-dark">
        <tr>
            <th>ФИО / Дата</th>
            @foreach (var col in ViewBag.days)
            {
                <th><input type="text" readonly value="@col.Day . @col.Month" asp-for="Date" /></th>
            }
            <th>Четверть @ViewBag.Q</th>
        </tr>
        @foreach (var fio in ViewBag.names)
        {
            <tr>
                <td><input type="text" readonly value="@fio" asp-for="Pupils_marks" /></td>
                @for (int i = 0; i < ViewBag.days.Count + 1; i++)
                {
                    <td><input type="text" style="width:25px" asp-for="Pupils_marks" /></td>
                }
            </tr>
        }
    </table>
    <input type="submit" value="Сохранить" />
</form>

<form asp-action="EditMagazineAndView" asp-controller="SchoolMagazine" asp-route-Class="@ViewBag.ClassNumber" asp-route-ClassLetter="@ViewBag.ClassLetter" method="post">
    <input type="submit" value="редачить/позырить" />
</form>

<script>
        var subject = document.getElementById('Subject');
        subject.onchange = function () {
            document.cookie = 'Subject=' + subject.value + '; path=/;';
        };
        var quarter = document.getElementById('Quarters');
        quarter.onchange = function () {
            document.cookie = 'Quarter=' + quarter.value + '; path=/;';
        };
        function getCookie(name) {
            var matches = document.cookie.match(new RegExp(
                "(?:^|; )" + name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, '\\$1') + "=([^;]*)"
            ));
            return matches ? decodeURIComponent(matches[1]) : undefined;
        }
        var select = document.getElementById('Subject'),
            cookie = getCookie('Subject');
        var select2 = document.getElementById('Quarters'),
            cookie2 = getCookie('Quarter');
        if (cookie) {
            select.value = cookie;
        }
        if (cookie2) {
            select2.value = cookie2;
        }
        var value = document.getElementById('Subject').value;
        document.getElementById('sub').value = value
</script>
